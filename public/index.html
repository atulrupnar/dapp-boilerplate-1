<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
  </head>
<body ng-app="mymodal">
<div ng-controller="MainCtrl" class="container">
  <h1>Getter/Setter DAPP</h1>
  <br>
  <h3>Set Values</h3>
    <div class="row">
        <div class="form-group col-md-6">
            <!-- <label class="col-md-3">Set Number</label> -->
            <div class="col-md-6">
                <input class="form-control" type="text" ng-model="no" placeholder="Enter Number" />
            </div>
            <div class="col-md-3">
                <button ng-click="setNo()" class="btn btn-success">Set Number</button>
            </div>
        </div>
        <div class="form-group col-md-6">
            <div class="col-md-6">
                <input class="form-control" type="text" ng-model="str" placeholder="Enter Number" />
            </div>
            <div class="col-md-3">
                <button ng-click="setStr()" class="btn btn-success">Set String</button>
            </div>
        </div>
    </div>
    <div class="form-group">
        <h3>Get Values</h3>
    </div>
    <div class="row">
        <div class="form-group col-md-6">
            <div class="col-md-6">
                <input class="form-control" type="text" ng-model="no2" readonly="readonly" />
            </div>
            <div class="col-md-3">
                <button ng-click="getNo()" class="btn btn-primary">Get Number</button>
            </div>
        </div>

        <div class="form-group col-md-6">
            <div class="col-md-6">
                <input class="form-control" type="text" ng-model="str2" readonly="readonly" />
            </div>
            <div class="col-md-3">
                <button ng-click="getStr()" class="btn btn-primary">Get String</button>
            </div>
        </div>
    </div>
    <div class="form-group">
        <h3>Events <button ng-click="getAllEvents()" class="btn btn-warning">Update Events</button></h3>
    </div>
    <div class="row">
        <table class="table table-striped">
            <thead>
              <tr>
                <th>Event</th>
                <th>Transaction Hash</th>
                <th>Data
                </th>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="event in allEvents">
                <td>{{event.event}}</td>
                <td>{{event.transactionHash}}</td>
                <td>{{event.args}}</td>
              </tr>
            </tbody>
        </table>        
    </div>
</div>
<script>
var mymodal = angular.module('mymodal', []);

mymodal.controller('MainCtrl', function ($scope, $http) {
    $scope.no = 0
    $scope.str = "hello"
    $scope.no2 = 0
    $scope.str2 = "hello"    
    $scope.allEvents = []
    console.log("hiii")
    $scope.setNo = function() {
        console.log("setNo")
        $http.post("/setNo", {no : $scope.no})
        .then(function(response) {
            alert("Success");
        }, function(response) {
            alert("Error");
        });
    }
    $scope.setStr = function() {
        $http.post("/setStr", {str : $scope.str})
        .then(function(response) {
            alert("Success");
        }, function(response) {
            alert("Error");
        });
    }
    $scope.getNo = function() {
        console.log("inside getNo");
        $http.get("/getNo")
        .then(function(response) {
            console.log(response)
            if (response.data && response.data.status) {
                $scope.no2 = response.data.no;
            } else {
                alert('Error')
            }
        }, function(response) {
            alert("Error");
        });
    }
    $scope.getStr = function() {
        $http.get("/getStr")
        .then(function(response) {
            if (response.data && response.data.status) {
                $scope.str2 = response.data.str;
            } else {
                alert('Error')
            }
        }, function(response) {
            alert("Error");
        });
    }

    $scope.getAllEvents = function() {
        $http.get("/allEvents")
        .then(function(response) {
            if (response.data && response.data.status) {
                $scope.allEvents = response.data.allEvents;
            } else {
                alert('Error')
            }
        }, function(response) {
            alert("Error");
        });
    }

});
</script>
</body>
</html>